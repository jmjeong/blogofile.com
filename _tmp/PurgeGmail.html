

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">Gmail 메일 정리하기 <span class="timestamp-wrapper"> <span class="timestamp">2009-11-17 Tue 14:19</span></span> &nbsp;&nbsp;&nbsp;<span class="tag"><span class="mail">mail</span>&nbsp;<span class="python">python</span></span></h2>
<div class="outline-text-2" id="text-1">


<p>
회사 메일을 forward 하여 보는 용도로 사용 중인 gmail 계정이 최근 quota가 다 찼다.  2007년 9월부터
forward를 시작했으니 2년 3개월 동안 7392M를 사용했다.
</p>


<img src="http://grab.by/C8a">

<p>
Gmail이니 혹시 soft quota가 적용되어서 경고 메시지는 보여주되 메일을 받아주거나, 혹은 upgrade 요청
popup등이 뜨지 않을까 생각했었는데, 애초 생각했던대로 quota exceed 경고를 보내주고 메일을 반송했다.
</p>


<img src="http://grab.by/C89">

<p>
백업 목적의 메일이니 몇 년전 메일을 지우려고 하는데 gmail 인터페이스에서 한꺼번에 지우는 방법을 찾을
수가 없었다. offlineimap이나 gnus에서 처리하는 방법도 데이타를 다 받아와야 해서 속도가 느린 문제가
있다.
</p>
<p>
간단한 python 프로그램을 만들어서 특정날짜 이전의 메일은 삭제하도록 했다. IMAP4 protocol에 
<code>(before '02-Jan-2008')</code>과 같이 해당 날짜 이전의 메일에 대해서만 읽어오는 인터페이스가 유용했다.
</p>

<ul>
<li>
첫번째 버젼 : <a href="http://gist.github.com/236756">http://gist.github.com/236756</a>
<dl>
<dt>문제점</dt><dd>
테스트할 때에는 전체 보관함에서 메일이 없어서 정상적으로 삭제되었다고 생각했는데, 실제
quota는 늘어나지 않는다. Gmail의 특성상 메일이 삭제하면 실제 mail을 삭제하는 것이
아니고, 해당 메일에서 라벨만 제거하는 식으로 동작을 한다.  메시지를 '휴지통'으로 이동한
후, 휴지통에서 삭제하는 방법을 사용해야 한다.
</dd>
<dt>개선점</dt><dd>
Verbose tag가 없으면 빠른 처리를 위해 store에 <code>message id</code> set을 넘겨서 한꺼번에
처리하는 방법이 나을 것 같다.

</dd>
</dl>
</li>
<li>
수정버젼



<script src="http://gist.github.com/236838.js"></script>

</li>
</ul>

</div>

<div id="outline-container-1.1" class="outline-3">
<h3 id="sec-1.1">읽어볼만한 글 </h3>
<div class="outline-text-3" id="text-1.1">


<ul>
<li>
<a href="http://bugs.python.org/issue1389051">python 2.5.1의 imap4_ssl library bug &amp; patch</a>
</li>
<li>
<a href="http://www.doughellmann.com/PyMOTW/imaplib/">imaplib - IMAP4 client library</a>

</li>
</ul>
</div>

</div>

<div id="outline-container-1.2" class="outline-3">
<h3 id="sec-1.2">Comments <span class="timestamp-wrapper"> <span class="timestamp">2009-12-04 Fri</span></span> </h3>
<div class="outline-text-3" id="text-1.2">


<p>
Gmail 계정은 이론상 무한정으로 만들 수 있으므로, 메일을 archive하는 submail 계정을 만들어서,
이쪽으로 메일 내용을 옮기는게 더 좋다. <code>환경설정</code> - <code>계정</code> - <code>다른 계정에서 메일 가져오기</code>를
선택하여 POP3로 메일을 옮겨온다. 추후 예전 메일 검색은 archive된 계정에서 검색을 하면 된다. 
</p>

</div>
</div>
</div>
